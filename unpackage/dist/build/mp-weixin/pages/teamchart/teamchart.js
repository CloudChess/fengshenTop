"use strict";const t=require("../../common/vendor.js"),e={data:()=>({colunmopts:{legend:{show:!1},color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#FC8452","#9A60B4","#ea7ccc"],padding:[15,15,0,5],enableScroll:!1,legend:{show:!1},xAxis:{disableGrid:!0},yAxis:{disabled:!0,format:"yAxisNotFloat",data:[{format:"yAxisNotFloat",min:0}]}},baropts:{color:["#1890FF","#91CB74","#FAC858","#EE6666","#73C0DE","#3CA272","#FC8452","#9A60B4","#ea7ccc"],padding:[15,30,0,5],enableScroll:!1,legend:{show:!1},xAxis:{boundaryGap:"justify",disableGrid:!1,min:0,axisLine:!1},xAxis:{disabled:!0},extra:{bar:{type:"stack",width:30,meterBorde:1,meterFillColor:"#FFFFFF",activeBgColor:"#000000",activeBgOpacity:.08,categoryGap:2}}},chartData_num:{},chartData_age:{},chartData_job_type:{},chartData_skill_level:{},workShop:"",workShopInfo:[],teamInfo:[]}),methods:{toTeaminfo(){t.index.navigateTo({url:"/pages/teaminfo/teaminfo"})},setWorkshop(t){this.workShop==t?(this.workShop="",this.workShopInfo=this.teamInfo):(this.workShop=t,this.workShopInfo=this.teamInfo.filter((t=>t.emp_workshop==this.workShop))),this.updateInfo()},getColumnChartData(t,e){let a=[],o=[];this.workShopInfo.forEach((e=>{let r=!1;for(let s=0;s<a.length;s++)e[t]==a[s]&&(r=!0,o[s]++);r||(a.push(e[t]),o.push(1))}));let r={categories:a,series:[{name:"人数",data:o}]};this[e]=JSON.parse(JSON.stringify(r))},getPieChartData(t,e){let a=[];this.workShopInfo.forEach((e=>{let o=!1;a.forEach((a=>{a.name==e[t]&&(a.value++,o=!0)})),o||a.push({name:e[t],value:1})})),a.map((t=>{t.labelText=t.name+":"+t.value+"人"}));let o={series:[{data:a}]};this[e]=JSON.parse(JSON.stringify(o))},updateInfo(){this.getColumnChartData("emp_workshop","chartData_num"),this.getPieChartData("emp_birth_date","chartData_age"),this.getPieChartData("emp_job_type","chartData_job_type"),this.getColumnChartData("emp_skill_level","chartData_skill_level"),console.log(this.chartData_skill_level)},getTeamInfo(){let e=t.index.getStorageSync("token"),a=t.index.getStorageSync("username");t.index.request({url:"http://www.fengji.com:90/getteaminfo.php",method:"POST",header:{Authorization:"Bearer "+e},data:{username:a},success:t=>{t.data.data&&(this.teamInfo=t.data.data,this.workShopInfo=this.teamInfo,this.updateInfo())}})}},mounted(){this.getTeamInfo()}};if(!Array){(t.resolveComponent("MyHeader")+t.resolveComponent("uni-section")+t.resolveComponent("qiun-data-charts"))()}Math||((()=>"../../components/MyHeader/MyHeader.js")+(()=>"../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../uni_modules/qiun-data-charts/components/qiun-data-charts/qiun-data-charts.js"))();const a=t._export_sfc(e,[["render",function(e,a,o,r,s,i){return{a:t.p({title:"团队报表"}),b:t.p({title:"人数统计  总人数："+s.workShopInfo.length,type:"line"}),c:t.p({type:"column",opts:s.colunmopts,chartData:s.chartData_num}),d:t.p({title:"工种分布",type:"line"}),e:t.p({type:"pie",chartData:s.chartData_job_type}),f:t.p({title:"技能等级分布",type:"line"}),g:t.p({type:"bar",opts:s.baropts,chartData:s.chartData_skill_level}),h:"炼胶"==s.workShop?1:"",i:t.o((t=>i.setWorkshop("炼胶"))),j:"压出"==s.workShop?1:"",k:t.o((t=>i.setWorkshop("压出"))),l:"成型"==s.workShop?1:"",m:t.o((t=>i.setWorkshop("成型"))),n:"硫化"==s.workShop?1:"",o:t.o((t=>i.setWorkshop("硫化"))),p:"成品"==s.workShop?1:"",q:t.o((t=>i.setWorkshop("成品"))),r:"叉车"==s.workShop?1:"",s:t.o((t=>i.setWorkshop("叉车"))),t:t.o((t=>i.toTeaminfo()))}}]]);wx.createPage(a);
