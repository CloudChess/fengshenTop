import{_ as t,L as e,r as a,l as s,M as l,N as i,m as o,o as n,c,w as f,i as r,b as h,d,t as u,h as p,u as _,f as g,O as m,P as x,S as w,Q as F}from"./index-BmSdLlR2.js";import{_ as S}from"./MyHeader.DeBaNa5e.js";import{r as b}from"./uni-app.es.YhHd3PI_.js";import{_ as y}from"./MyBottom.CcLQBUlQ.js";const W=t({data:()=>({togShow:1,personinfo:{},ctx:null,fieldMapConfig:{emp_perf:"绩效",EAM_inspection:"EAM巡检",PM_score:"PM",QA_score:"QA",execution_ability:"执行力",labor:"劳动纪律",leakage_rate:"泄漏",operation_rate:"运转率",safety:"本质安全",threeInspection:"三级检查",threeQualification:"三称合格率"},WaterFallopt:{data:{},scoreRect:{width:20,height:40},leftRect:{width:30,height:260},width:0,height:0}}),methods:{handleBack(){e()},togPage(t){this.togShow=t.detail.current},getPersonInfo(t,e,s){a({url:"http://10.72.59.63:90/getpersoninfo.php",method:"POST",header:{Authorization:"Bearer "+e},data:{pid:t,username:s},success:t=>{t.data&&t.data.data&&(this.personinfo=t.data.data)},fail(t){}})},getPersonPerfMonth(t,e,s,l,i){a({url:"http://10.72.59.63:90/getpersonPerfMonth.php",method:"POST",header:{Authorization:"Bearer "+e},data:{pid:Number(t),username:s,year:l,month:4},success:t=>{if(t.data&&t.data.data){let e=t.data.data,a={};a.total=Number(e.total_score),a.execution_ability=Number(e.execution_ability),a.EAM_inspection=Number(e.EAM_inspection),a.PM_score=Number(e.PM_score),a.QA_score=Number(e.QA_score),a.labor=Number(e.labor),a.leakage_rate=Number(e.leakage_rate),a.operation_rate=Number(e.operation_rate),a.safety=Number(e.safety),a.threeInspection=Number(e.threeInspection),a.threeQualification=Number(e.threeQualification),this.WaterFallopt.data=a}},fail(t){}})},drawWaterFallChart(){let t=0,e=0,a=20,s="#87a4f3",l="#a0d3ff",i="#eeeeee",o="";function n(s,l,i,o,n,c){s.beginPath(),s.setTextAlign("center"),s.setFillStyle("#000000"),s.setFontSize(8),s.fillText(i,e*(l.scoreRect.width+c)+l.scoreRect.width/2+n,t+a+o)}const c=(o,c,f,r,h)=>{let d=h/(this.WaterFallopt.data.total-this.WaterFallopt.data.execution_ability)*this.WaterFallopt.leftRect.height,u="#9dc0f3";n(this.ctx,this.WaterFallopt,h,0,26,11),n(this.ctx,this.WaterFallopt,r,d+8,26,11),o.beginPath(),o.setStrokeStyle("#f3f3f3"),o.moveTo(this.WaterFallopt.leftRect.width+26,t+a),o.lineTo(e*(c.scoreRect.width+11)+26,t+a),o.stroke(),o.beginPath(),o.rect(e*(c.scoreRect.width+11)+26,t+a,c.scoreRect.width,d),h/f<.7&&(u=i),h/f>.7&&(u=l),h/f>.9&&(u=s),o.setFillStyle(u),o.fill(),t+=d};function f(t,e,a,s){t.beginPath(),t.rect(e,3,20,4),t.setFillStyle(s),t.fill(),t.setFontSize(8),t.setFillStyle("#000000"),t.fillText(a,e+26,7)}f(this.ctx,200,"优秀",s),f(this.ctx,250,"良好",l),f(this.ctx,300,"一般",i);for(let r in this.WaterFallopt.data){if("operation_rate"==r||"labor"==r)c(this.ctx,this.WaterFallopt,20,this.fieldMapConfig[r],this.WaterFallopt.data[r]);else if("total"==r)this.ctx.beginPath(),this.ctx.rect(16,a,this.WaterFallopt.leftRect.width,this.WaterFallopt.leftRect.height),this.WaterFallopt.data[r]<80&&(this.ctx.setFillStyle(i),o="一般"),this.WaterFallopt.data[r]>80&&(this.ctx.setFillStyle(l),o="良好"),this.WaterFallopt.data[r]>90&&(this.ctx.setFillStyle(s),o="优秀"),this.ctx.fill(),this.ctx.beginPath(),this.ctx.setTextAlign("center"),this.ctx.setFillStyle("#000000"),this.ctx.setFontSize(9),this.ctx.fillText(this.WaterFallopt.data.total,16+this.WaterFallopt.leftRect.width/2,this.WaterFallopt.leftRect.height/2+a);else{if("execution_ability"==r&&0==this.WaterFallopt.data[r])continue;if("execution_ability"==r&&0!=this.WaterFallopt.data[r]){this.ctx.setFillStyle("#000000"),this.ctx.setFontSize(10),this.ctx.fillText("补充说明：",80,250),this.ctx.fillText("执行力："+this.WaterFallopt.data[r],80,270);continue}c(this.ctx,this.WaterFallopt,10,this.fieldMapConfig[r],this.WaterFallopt.data[r])}e++}this.ctx.setFillStyle("#000000"),this.ctx.font="12px 楷体",this.ctx.fillText("月度总评：",250,80),this.ctx.setFillStyle("#ff6ee0"),this.ctx.font="20px 隶书",this.ctx.fillText(o,300,80),this.ctx.draw()}},watch:{"WaterFallopt.data":{handler:function(t,e){this.drawWaterFallChart()},deep:!0}},onLoad(t){let e=t.to,a=t.pid;t.perf;let l=s("token"),i=s("username");this.togShow=e,this.getPersonInfo(a,l,i);let o=new Date,n=o.getFullYear(),c=o.getMonth();this.getPersonPerfMonth(a,l,i,n,c)},onReady(){this.ctx=l("waterfallChart",this),i({success:t=>{this.WaterFallopt.width=t.screenWidth,this.WaterFallopt.height=t.screenHeight}})}},[["render",function(t,e,a,s,l,i){const W=b(o("MyHeader"),S),P=g,T=r,M=m,C=x,R=w,k=F,N=b(o("MyBottom"),y);return n(),c(T,{class:"teaminfoDetail"},{default:f((()=>[h(W,{title:"员工信息"}),h(T,{class:"container"},{default:f((()=>[h(T,{class:"infoCard"},{default:f((()=>[h(T,{class:"simple-info"},{default:f((()=>[h(T,{class:"simple-left simple-v"},{default:f((()=>[h(T,{class:"info-cell"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("姓名：")])),_:1}),h(P,{class:"simpleinfo-txt"},{default:f((()=>[d(u(l.personinfo.emp_name),1)])),_:1})])),_:1}),h(T,{class:"info-cell"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("学历：")])),_:1}),h(P,{class:"simpleinfo-txt"},{default:f((()=>[d(u(l.personinfo.emp_education),1)])),_:1})])),_:1})])),_:1}),h(T,{class:"simple-mid simple-v"},{default:f((()=>[h(T,{class:"info-cell"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("工种：")])),_:1}),h(P,{class:"simpleinfo-txt"},{default:f((()=>[d(u(l.personinfo.emp_job_type),1)])),_:1})])),_:1}),h(T,{class:"info-cell"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("等级：")])),_:1}),h(P,{class:"simpleinfo-txt"},{default:f((()=>[d(u(l.personinfo.emp_skill_level),1)])),_:1})])),_:1})])),_:1}),h(T,{class:"simple-right"},{default:f((()=>[p("img",{class:"info-img",src:l.personinfo.emp_photo},null,8,["src"])])),_:1})])),_:1})])),_:1}),h(T,{class:"subLine-groove"},{default:f((()=>[h(T,{class:_(["subLineTag",{selectedTag:0==l.togShow}]),onClick:e[0]||(e[0]=t=>l.togShow=0)},{default:f((()=>[d("日绩效")])),_:1},8,["class"]),h(T,{class:_(["subLineTag",{selectedTag:1==l.togShow}]),onClick:e[1]||(e[1]=t=>l.togShow=1)},{default:f((()=>[d("月绩效")])),_:1},8,["class"]),h(T,{class:_(["subLineTag",{selectedTag:2==l.togShow}]),onClick:e[2]||(e[2]=t=>l.togShow=2)},{default:f((()=>[d("基本信息")])),_:1},8,["class"]),h(T,{class:_(["subLineTag",{selectedTag:3==l.togShow}]),onClick:e[3]||(e[3]=t=>l.togShow=3)},{default:f((()=>[d("更多信息")])),_:1},8,["class"]),h(T,{class:_(["subLine",{swiperLineSecond:1==l.togShow,swiperLineThird:2==l.togShow,swiperLineFour:3==l.togShow}])},null,8,["class"])])),_:1}),h(k,{class:"swiper",autoplay:!1,duration:450,current:l.togShow,onChange:e[4]||(e[4]=t=>i.togPage(t))},{default:f((()=>[h(M,null,{default:f((()=>[h(T,{class:"swiper-item chartInfo"},{default:f((()=>[d("a")])),_:1})])),_:1}),h(M,null,{default:f((()=>[h(R,{class:"swiper-scroll"},{default:f((()=>[h(T,{class:"swiper-item perfMonth"},{default:f((()=>[h(T,{class:"OneSence"}),h(T,{class:"personChart"},{default:f((()=>[h(C,{"canvas-id":"waterfallChart",style:{width:"1200px",height:"1257px"}})])),_:1})])),_:1})])),_:1})])),_:1}),h(M,null,{default:f((()=>[h(R,{class:"swiper-scroll"},{default:f((()=>[h(T,{class:"swiper-item textInfo"},{default:f((()=>[h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("性别：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_gender),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("年龄：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_age),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("司龄：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_service_years),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("工段：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_workshop),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("班组：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_team),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("毕业院校：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_school),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("专业：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_major||"无"),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("优势：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_advantage||"暂无"),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("不足：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_deficiency||"暂无"),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),h(M,null,{default:f((()=>[h(R,{class:"swiper-scroll"},{default:f((()=>[h(T,{class:"swiper-item textInfo"},{default:f((()=>[h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("荣誉：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_honor||"暂无"),1)])),_:1})])),_:1}),h(T,{class:"info-item"},{default:f((()=>[h(P,{class:"infotag"},{default:f((()=>[d("成长经历：")])),_:1}),h(P,{class:""},{default:f((()=>[d(u(l.personinfo.emp_growth_record||"暂无"),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["current"])])),_:1}),h(N)])),_:1})}],["__scopeId","data-v-8e5c1127"]]);export{W as default};
