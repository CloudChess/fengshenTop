import{_ as e,n as t,l as a,r as s,m as l,o as r,c as o,w as i,i as n,b as d,q as m,g as f,x as p,F as c,d as u,j as h,S as _,t as g}from"./index-BmSdLlR2.js";import{_ as D}from"./MyHeader.DeBaNa5e.js";import{r as b}from"./uni-app.es.YhHd3PI_.js";import{_ as k}from"./uni-data-picker.UVAqS254.js";import{_ as y}from"./MyBottom.CcLQBUlQ.js";import"./uni-cloud.es.DjwZVFm8.js";const j=e({data:()=>({teaminfo:{leader:[],people:[]},perfinfo:{},absoluteItem:"",perfDate:"",selectDate:[],team:"",order:1}),computed:{sortPeople(){if(this.teaminfo.people&&this.perfinfo)return this.teaminfo.people.sort(((e,t)=>this.order?Number(this.perfinfo[t.empid])-Number(this.perfinfo[e.empid]):Number(this.perfinfo[e.empid])-Number(this.perfinfo[t.empid]))),console.log(this.teaminfo.people),this.teaminfo.people}},methods:{scrollHandle(e){},toDetail(e){t({url:"/pages/teaminfoDetail/teaminfoDetail?pid="+e+"&to=1"})},changeOrder(){this.order=!this.order},creatDateTree(e){let t=[];for(let a=e;a<=e+3;a++){let e={text:String(a),value:String(a),children:[]};for(let t=1;t<=12;t++){let s=t<10?"0"+t:String(t),l={text:s+"月",value:a+"-"+s};e.children.push(l)}t.push(e)}this.selectDate=t},changeHandle(e){if(7==this.perfDate.length){let e=this.perfDate.split("-");this.getTeamInfoPerf(this.team,e[0],e[1])}},getTeamInfo(e){let t=a("token"),l=a("username");s({url:"http://10.72.59.63:90/getteaminfobyteam.php",method:"POST",header:{Authorization:"Bearer "+t},data:{username:l,team:e},success:e=>{if(e.data&&e.data.data){let t=[];e.data.data.map((e=>{"组长"==e.emp_job?this.teaminfo.leader.push(e):"副组长"==e.emp_job?t.push(e):this.teaminfo.people.push(e)})),this.teaminfo.leader.push(...t)}}})},getTeamInfoPerf(e,t,l){let r=a("token"),o=a("username");s({url:"http://10.72.59.63:90/getPerfbyteam.php",method:"POST",header:{Authorization:"Bearer "+r},data:{username:o,team:e,year:t,month:l},success:e=>{e.data&&e.data.data&&(this.perfinfo=e.data.data.reduce((function(e,t){return e[t.emp_id]=t.emp_perf,e}),{}))}})}},mounted(){},onLoad(e){if(this.team=e.team,this.team&&(this.getTeamInfo(this.team),this.getTeamInfoPerf(this.team)),this.creatDateTree(2023),e.year){let t=(new Date).getMonth()+1;t=t<10?"0"+t:String(t),this.perfDate=e.year+"-"+t}}},[["render",function(e,t,a,s,j,I){const S=b(l("MyHeader"),D),T=b(l("uni-data-picker"),k),x=n,C=_,P=b(l("MyBottom"),y);return r(),o(x,{class:"teamStruct"},{default:i((()=>[d(S,{title:""}),d(T,{placeholder:"年份/月份",modelValue:j.perfDate,"onUpdate:modelValue":t[0]||(t[0]=e=>j.perfDate=e),localdata:j.selectDate,onChange:I.changeHandle,preload:!0},null,8,["modelValue","localdata","onChange"]),d(x,{class:"picker-blank"}),d(C,{class:"container","scroll-y":"true",onScroll:I.scrollHandle},{default:i((()=>[d(x,{class:"teamList"},{default:i((()=>[d(x,{class:"list-leader"},{default:i((()=>[d(x,{class:"listText",style:m(j.absoluteItem)},{default:i((()=>[(r(!0),f(c,null,p(j.teaminfo.leader,((e,t)=>(r(),o(x,{class:"listItem",onClick:t=>I.toDetail(e.empid)},{default:i((()=>[d(x,{class:"listItem-left"},{default:i((()=>["组长"==e.emp_job?(r(),o(x,{key:0,class:"icon leader"})):h("",!0),"副组长"==e.emp_job?(r(),o(x,{key:1,class:"icon sublearder"})):h("",!0),d(x,{class:"name"},{default:i((()=>[u(g(e.emp_name),1)])),_:2},1024),d(x,{class:"job"},{default:i((()=>[u(g(e.emp_job),1)])),_:2},1024)])),_:2},1024),d(x,{class:"listItem-right"},{default:i((()=>[d(x,{class:"perf"},{default:i((()=>[u(g(j.perfinfo[e.empid]),1)])),_:2},1024),j.perfinfo[e.empid]?h("",!0):(r(),o(x,{key:0,class:"perf-noData"},{default:i((()=>[u("本月无绩效")])),_:1}))])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:1},8,["style"]),d(x,{class:"list-more"},{default:i((()=>[(r(!0),f(c,null,p(I.sortPeople,((e,t)=>(r(),o(x,{class:"listItem",onClick:t=>I.toDetail(e.empid)},{default:i((()=>[d(x,{class:"listItem-left"},{default:i((()=>[d(x,{class:"icon"}),d(x,{class:"name"},{default:i((()=>[u(g(e.emp_name),1)])),_:2},1024)])),_:2},1024),d(x,{class:"listItem-right"},{default:i((()=>[d(x,{class:"perf"},{default:i((()=>[u(g(j.perfinfo[e.empid]),1)])),_:2},1024),j.perfinfo[e.empid]?h("",!0):(r(),o(x,{key:0,class:"perf-noData"},{default:i((()=>[u("本月无绩效")])),_:1}))])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:1})])),_:1})])),_:1})])),_:1},8,["onScroll"]),d(x,{class:"orderBtn",onClick:I.changeOrder},{default:i((()=>[j.order?h("",!0):(r(),o(x,{key:0,class:"orderBtn-text"},{default:i((()=>[u("↑升序")])),_:1})),j.order?(r(),o(x,{key:1,class:"orderBtn-text"},{default:i((()=>[u("↓降序")])),_:1})):h("",!0)])),_:1},8,["onClick"]),d(P)])),_:1})}],["__scopeId","data-v-7e7ba6c3"]]);export{j as default};
